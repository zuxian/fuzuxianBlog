(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{579:function(s,t,n){"use strict";n.r(t);var a=n(13),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"写一个自己的脚手架-cli"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#写一个自己的脚手架-cli"}},[s._v("#")]),s._v(" 写一个自己的脚手架/CLI")]),s._v(" "),n("p",[s._v("脚手架使用的功能")]),s._v(" "),n("blockquote",[n("ul",[n("li",[s._v("用户输入命令，准备创建项目。")]),s._v(" "),n("li",[s._v("脚手架解析用户命令，并弹出交互语句，询问用户创建项目需要哪些功能。")]),s._v(" "),n("li",[s._v("用户选择自己需要的功能。")]),s._v(" "),n("li",[s._v("脚手架根据用户的选择创建 "),n("code",[s._v("package.json")]),s._v(" 文件，并添加对应的依赖项。")]),s._v(" "),n("li",[s._v("脚手架根据用户的选择渲染项目模板，生成文件（例如 "),n("code",[s._v("index.html")]),s._v("、"),n("code",[s._v("main.js")]),s._v("、"),n("code",[s._v("App.vue")]),s._v(" 等文件）。")]),s._v(" "),n("li",[s._v("执行 "),n("code",[s._v("npm install")]),s._v(" 命令安装依赖。")])])]),s._v(" "),n("p",[s._v("脚手架 ---- "),n("strong",[s._v("三方依赖库")])]),s._v(" "),n("blockquote",[n("ul",[n("li",[s._v("commander： 命令行自定义指令")]),s._v(" "),n("li",[s._v("inquirer：提供问答式的命令行交互方法，可以收集获取命令行的回答的结果，然后进行操作")]),s._v(" "),n("li",[s._v("chalk：命令行多彩打印")]),s._v(" "),n("li",[s._v("cross-spawn：跨平台 shell 工具，比如安装依赖")]),s._v(" "),n("li",[s._v("download-git-repo：下载远程模板")]),s._v(" "),n("li",[s._v("ora:  命令行 loading 动效")])])]),s._v(" "),n("h2",{attrs:{id:"初始化搭建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化搭建"}},[s._v("#")]),s._v(" "),n("strong",[s._v("初始化搭建")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 新建项目目录 my-node-cli")]),s._v("\nmkdir my"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cli \ncd my"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cli \nnpm init \t  # 生成 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json 文件\n\ntouch cli"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js  # 新建 cli"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js 文件\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在 package.json 文件中指定入口文件为 cli.js")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-node-cli"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0.0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"main"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cli.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"bin"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cli.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n      \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在cli.js文件的开头加入")]),s._v("\n#"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("env node\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my-node-cli working~'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 链接到全局")]),s._v("\nnpm link \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在命令行中输入 my-node-cli 执行一下")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[n("code",[s._v("#！")]),s._v("这个符号通常在第一行开头中出现，用于指明这个脚本文件的解释程序。\n/usr/bin/env就是告诉系统可以在PATH目录中查找，")]),s._v(" "),n("p",[s._v("配置#!/usr/bin/env node, 就是解决了不同的用户node路径不同的问题，让系统动态的去查找node来执行你的脚本文件。")]),s._v(" "),n("h2",{attrs:{id:"增加基本功能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#增加基本功能"}},[s._v("#")]),s._v(" "),n("strong",[s._v("增加基本功能")])]),s._v(" "),n("ul",[n("li",[s._v("生成对应的文件")])]),s._v(" "),n("p",[s._v("安装 ejs 模版引擎将用户输入的数据渲染到模版文件上"),n("code",[s._v("npm install ejs --save # yarn add ejs --save")])]),s._v(" "),n("ul",[n("li",[n("p",[s._v("处理用户命令")]),s._v(" "),n("p",[s._v("使用 commander 注册了一个 create 命令，并设置了脚手架的版本和描述")])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token hashbang comment"}},[s._v("#!/usr/bin/env node")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" program "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'commander'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" create "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../lib/create'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nprogram\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0.1.0'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'create <name>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("description")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'create a new project'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("action")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("name")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nprogram"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("将这段代码保存在项目下的 bin 目录，并命名为 mvc.js。")]),s._v(" "),n("p",[s._v("在 package.json 添加"),n("code",[s._v('"bin": { "mvc": "./bin/mvc.js" }')]),s._v("，再执行 npm link，将 mvc 注册成全局命令")]),s._v(" "),n("p",[n("code",[s._v("mvc create demo")]),s._v("（实际上是 "),n("code",[s._v("node ./bin/mvc.js create demo")]),s._v("）")]),s._v(" "),n("h2",{attrs:{id:"发布项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发布项目"}},[s._v("#")]),s._v(" 发布项目")]),s._v(" "),n("p",[s._v("第一步，在 git 上建好仓库\n第二步，完善 package.json 中的配置\n第三步，使用 npm publish 进行发布，更新到时候，注意修改版本号")]),s._v(" "),n("p",[s._v("参考：")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6966119324478079007",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://juejin.cn/post/6966119324478079007"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6932610749906812935",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://juejin.cn/post/6932610749906812935"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);